<div class="container mt-3 maint">
    <div class="row">
        <div class="col-2">
            <div>
                <div>
                    <h3><%= link_to semesters_path, class: "" do %><%= image_tag "arrow-left-circle-fill.svg", class:"mr-1", style: "height:32px"%><% end %><%= @semester.semester%> <%= @semester.year%></h3>
                    <ul class="list-unstyled ps-0">
                        
<!--                        <li class="mb-1"><%#= link_to "Add API Key", enter_github_key_path(@semester), class: "btn btn-t d-inline-flex align-items-center rounded border-0"%></li>-->
<!--                        <li class="mb-1"><%#= link_to "New Repository", post_new_repository_path(@semester), class: "btn btn-t d-inline-flex align-items-center rounded border-0"%></li>-->
                        <li class="border-top my-3"></li>
                        <li class="mb-1"><%= link_to "Edit Semester", edit_semester_path(@semester), class: "btn btn-t d-inline-flex align-items-center rounded border-0"%></li>
<!--                        <li class="mb-1"><%#= link_to "Edit Sprints", semester_sprints_path(@semester), class: "btn btn-t d-inline-flex align-items-center rounded border-0"%></li>-->
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-10 justify-content-center align-items-center text-center">
            <div class="row">
                <div class="col-6">
                    <h2>Student Survey</h2>
                    <%= bootstrap_form_with url: semester_team_path(@semester), method: "get", local: true do |f|%>
                        <%= f.select :team, @teams %>
                        <%= f.select :sprint, @sprintList %>
                        <%= f.submit "View"%>
                    <% end %>
                </div>

<!--              HIDING GITHUB ACTIVITY UNTIL IT IS PROPERLY WORKING-->
<!--                <div class="col-6">-->
<!--                    <h2>GitHub Activity</h2>-->
                    <%#= form_with(url: show_repository_url(@semester), method: "get", local: true) do%>
<!--                        <div class = "mb-3">-->
<!--                            <label class = "form-label" for = "repo_id">Team</label>-->
<!--                            <select name = "repo_id" class = "form-select">-->
                                <%#= @repos.each do |repo| %>
<!--                                    <option <%#=if session[:repo_id]=="#{repo.id}" then "selected" end%> value="<%#= repo.id %>"><%#= repo.team %></option>-->
                                <%# end %>
<!--                            </select>-->
<!--                        </div>-->
<!--                        <div class = "mb-3">-->
<!--                            <label class = "form-label" for = "repo_id">Sprint</label>-->
<!--                            <select name = "sprint_id" class = "form-select">-->
                            <%#= @sprints.each do |sprint| %>
<!--                                <option <%#=if session[:repo_sprint_id]=="#{sprint.id}" then "selected" end%> value="<%#= sprint.id  %>"><%#= sprint.name %></option>-->
                            <%# end %>
<!--                            </select>-->
<!--                        </div>-->
<!--                        <input type = "submit" name = "commit" value = "Submit" class="btn btn-secondary" data-disable-with = "Submit">-->
                    <%# end %>
<!--                    <p style = "color: red"><i class="material-icons">warning</i>This process takes a while to load!</p>-->
<!--                </div>-->
                <div class="mt-4">
                    <% if teamExist(@teams)%>
                        <h2>Team Status</h2>
                        <p>Note: Hover over warning symbol to see more details</p>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th scope="col">Team</th>
                                    <% @sprintList.each do |s| %>
                                        <th scope="col"><%= s %> Status</th>
                                    <% end %>
                                </tr>
                            </thead>
                            <tbody>
                                <% @teams.each do |item|%>
                                    <tr>
                                        <th><%= item %></th>
                                        <% @sprintList.each do |s| %>
                                            <td>
                                                <div class="d-flex flex-row m-0">
                                                    <% if @flags[s][item].include?("student blank")%>
                                                        <% if unfinishedSprint(@teams, @flags, s)%>
                                                            <div class="p-2 m-0"><p class="p-0 m-0"><%= image_tag "question-circle-fill.svg", class:"", style: "height:16px", title: "This sprint has not yet concluded"%></p></div>
                                                        <% else %>
                                                            <div class="p-2 m-0"><p class="p-0 m-0"><%= image_tag "exclamation-triangle-fill-red.svg", class:"", style: "height:16px", title: "All students failed to submit a survey"%></p></div>
                                                        <% end %>
                                                    <% elsif @flags[s][item].empty? %>
                                                        <div class="p-2 m-0"><p class="p-0 m-0"><%= image_tag "check-circle-fill.svg", class:"", style: "height:16px", title: "All is well"%></p></div>
                                                    <% else %>
                                                        <% if @flags[s][item].include?("missing submit") %>
                                                            <div class="p-2 m-0"><p class="p-0 m-0"><%= image_tag "exclamation-triangle-fill-red.svg", class:"", style: "height:16px", title: "At least one of the students failed to submit a survey"%></p></div>
                                                        <% end %>
                                                        <% if @flags[s][item].include?("low score") %>
                                                            <div class="p-2 m-0"><p class="p-0 m-0"><%= image_tag "exclamation-triangle-fill-red.svg", class:"", style: "height:16px", title: "At least one of the students received an average rating lower than 4"%></p></div>
                                                        <% end %>
                                                        <% if @flags[s][item].include?("no client score") %>
                                                            <div class="p-2 m-0"><p class="p-0 m-0"><%= image_tag "exclamation-triangle-fill-red.svg", class:"", style: "height:16px", title: "The client did not submit a survey"%></p></div>
                                                        <% end %>
                                                        <% if @flags[s][item].include?("low client score") %>
                                                            <div class="p-2 m-0"><p class="p-0 m-0"><%= image_tag "exclamation-triangle-fill-red.svg", class:"", style: "height:16px", title: "The client is unsatisfied"%></p></div>
                                                        <% end %>
                                                    <% end %>
                                                </div>
                                            </td>
                                        <% end %>
                                    </tr>
                                <% end %>
                            </tbody>
                        </table>
                    <% else %>
<!--                    TODO: Might need to add some content here-->
<!--                        <h2>There are no teams in this semester</h2>-->
                    <% end %>
                </div>
            </div>
        </div>
    </div>
</div>